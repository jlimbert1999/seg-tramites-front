<div class="col-12">
  <div class="border border-dark rounded p-3 h-100">
    <div class="fs-6 pb-2 mb-3 text-primary border-bottom border-dark">
      OBSERVACIONES
    </div>

    <div class="row">
      @if(enableOptions()){
      <div class="col-12">
        <mat-form-field appearance="outline" (click)="isFocused = true">
          <input
            matInput
            placeholder="Agrega una observacion"
            (blur)="(!isFocused)"
            [formControl]="descripcion"
          />
        </mat-form-field>
      </div>
      @if (isFocused) {
      <div class="col-12 d-flex justify-content-end">
        <button mat-button (click)="removeFocus()">Cancelar</button>
        <button
          mat-button
          color="primary"
          (click)="add()"
          [disabled]="descripcion.invalid"
        >
          Observar
        </button>
      </div>
      } }

      <div class="col-12 mt-3">
        <mat-list>
          @for (obs of observations(); track obs._id) {
          <mat-list-item>
            <mat-icon matListItemIcon>person</mat-icon>
            <div matListItemTitle>
              {{ obs.fullnameOfficer }}
              <span
                class="badge"
                [ngClass]="obs.isSolved ? 'bg-success' : 'bg-danger'"
              >
                {{ obs.isSolved ? "RESUELTO" : "PENDIENTE" }}
              </span>
            </div>
            <div matListItemLine>{{ obs.description }}</div>
            <div matListItemLine>{{ obs.date | date : "short" }}</div>
            @if(account === obs.account){
            <button matListItemMeta mat-icon-button [disabled]="obs.isSolved">
              <mat-icon>build</mat-icon>
            </button>
            }
          </mat-list-item>
          } @empty {
          <mat-list-item>
            <div matListItemTitle>SIN OBSERVACACIONES</div>
          </mat-list-item>
          }
        </mat-list>
      </div>
    </div>
  </div>
</div>
